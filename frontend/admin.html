<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0f172a;
      color: white;
      margin: 0;
      padding: 0;
    }
    h2, h3 { color: #38bdf8; }
    .container { width: 90%; max-width: 1000px; margin: auto; padding: 20px; }
    .section-card {
      background: #1e293b;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }
    label { display: block; margin-top: 10px; }
    input, select, textarea {
      width: 100%; padding: 8px; margin-top: 5px;
      border-radius: 8px; border: none;
    }
    .primary-btn {
      background: #2563eb;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 10px;
    }
    .primary-btn:hover { background: #1d4ed8; }
    table {
      width: 100%; margin-top: 10px; border-collapse: collapse;
    }
    th, td { padding: 8px; border-bottom: 1px solid #334155; text-align: left; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Admin Dashboard</h2>
    <p>Welcome, <span id="adminName">Admin</span> (<span id="adminEmail">admin@example.com</span>)
      <button onclick="editProfile()" class="primary-btn">Edit Profile</button>
      <button onclick="logout()" class="primary-btn">Logout</button>
    </p>

    <!-- USER MANAGEMENT -->
    <div class="section-card">
      <h3>User Management</h3>
      <form id="createUserForm">
        <label>Role:</label>
        <select id="role">
          <option value="student">Student</option>
          <option value="faculty">Faculty</option>
          <option value="moderator">Moderator</option>
          <option value="admin">Admin</option>
        </select>

        <label>Username:</label>
        <input type="text" id="username" placeholder="Enter username" required>

        <label>Password:</label>
        <input type="password" id="password" placeholder="Enter password" required>

        <button type="submit" class="primary-btn">Create User</button>
      </form>

      <h4>Delete User</h4>
      <select id="deleteUser"></select>
      <button onclick="deleteUser()" class="primary-btn">Delete User</button>

      <div id="userList"></div>
    </div>

    <!-- BATCH MANAGEMENT -->
    <div class="section-card">
      <h3>Batch Management</h3>
      <label>Select Batch (1â€“20):</label>
      <select id="deleteBatch"></select>
      <button onclick="deleteBatch()" class="primary-btn">Delete Batch</button>
    </div>

    <!-- BADGE MANAGEMENT -->
    <div class="section-card">
      <h3>Badge Management</h3>
      <label>User:</label>
      <select id="badgeUser"></select>

      <label>Badge Role:</label>
      <select id="badgeRole">
        <option value="admin">Admin</option>
        <option value="moderator">Moderator</option>
        <option value="faculty">Faculty</option>
        <option value="student">Student</option>
      </select>

      <button onclick="assignBadge()" class="primary-btn">Assign Badge</button>

      <h4>Delete Badge</h4>
      <select id="deleteBadgeUser"></select>
      <button onclick="deleteBadge()" class="primary-btn">Delete Badge</button>
    </div>

    <!-- ACADEMIC / ATTENDANCE / TEST -->
    <div class="section-card">
      <h3>Academic Data</h3>
      <form id="academicForm">
        <label>Type:</label>
        <select id="acadType">
          <option value="note">Note</option>
          <option value="assignment">Assignment</option>
          <option value="notice">Notice</option>
        </select>

        <label>Title:</label>
        <input type="text" id="acadTitle" placeholder="Enter title">

        <label>Description:</label>
        <textarea id="acadContent" rows="3"></textarea>

        <button type="submit" class="primary-btn">Add Academic Data</button>
      </form>
      <div id="academicList"></div>
    </div>
    <!-- ATTENDANCE MANAGEMENT -->
    <div class="section-card">
      <h3>Attendance Management</h3>
      <form id="attendanceForm">
        <label>Subject Name:</label>
        <input type="text" id="attendanceSubject" required>
        <label>Percentage:</label>
        <input type="number" id="attendancePercent" required min="0" max="100">
        <button type="submit" class="primary-btn">Add / Update Attendance</button>
      </form>

      <h4>Delete Subject</h4>
      <select id="deleteSubject"></select>
      <button onclick="deleteSubject()" class="primary-btn">Delete Subject</button>

      <div id="attendanceList"></div>
    </div>

    <!-- TEST MANAGEMENT -->
    <div class="section-card">
      <h3>Test Score Management</h3>
      <form id="testForm">
        <label>Subject Name:</label>
        <input type="text" id="testSubject" required>
        <label>Marks:</label>
        <input type="number" id="testMarks" required>
        <button type="submit" class="primary-btn">Add / Update Test</button>
      </form>

      <h4>Delete Test</h4>
      <select id="deleteTest"></select>
      <button onclick="deleteTest()" class="primary-btn">Delete Test</button>

      <div id="testList"></div>
    </div>

    <!-- CHARTS -->
    <div class="section-card">
      <h3>Analytics Charts</h3>
      <canvas id="attendanceChart"></canvas>
      <canvas id="testChart"></canvas>
    </div>

  </div> <!-- end container -->

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    let users = [];
    let batches = Array.from({ length: 20 }, (_, i) => i + 1);
    let attendance = [];
    let tests = [];
    let academicData = [];

    const userList = document.getElementById('userList');
    const deleteUserSelect = document.getElementById('deleteUser');
    const deleteBatchSelect = document.getElementById('deleteBatch');
    const badgeUser = document.getElementById('badgeUser');
    const deleteBadgeUser = document.getElementById('deleteBadgeUser');

    function refreshUsers() {
      userList.innerHTML = users.map(u => `<div>${u.username} (${u.role})</div>`).join('');
      deleteUserSelect.innerHTML = users.map(u => `<option>${u.username}</option>`).join('');
      badgeUser.innerHTML = deleteBadgeUser.innerHTML = users.map(u => `<option>${u.username}</option>`).join('');
      deleteBatchSelect.innerHTML = batches.map(b => `<option>Batch ${b}</option>`).join('');
    }

    document.getElementById('createUserForm').addEventListener('submit', e => {
      e.preventDefault();
      const role = role.value, username = document.getElementById('username').value;
      users.push({ username, role, badges: [role] });
      refreshUsers();
      e.target.reset();
    });

    function deleteUser() {
      const u = deleteUserSelect.value;
      users = users.filter(x => x.username !== u);
      refreshUsers();
    }

    function assignBadge() {
      const u = badgeUser.value, badge = badgeRole.value;
      const user = users.find(x => x.username === u);
      if (user && !user.badges.includes(badge)) user.badges.push(badge);
      refreshUsers();
    }

    function deleteBadge() {
      const u = deleteBadgeUser.value, badge = badgeRole.value;
      const user = users.find(x => x.username === u);
      if (user) user.badges = user.badges.filter(b => b !== badge);
      refreshUsers();
    }

    function deleteBatch() {
      const selected = parseInt(deleteBatchSelect.value.replace('Batch ', ''));
      batches = batches.filter(b => b !== selected);
      refreshUsers();
    }

    // Academic
    document.getElementById('academicForm').addEventListener('submit', e => {
      e.preventDefault();
      const type = acadType.value, title = acadTitle.value, desc = acadContent.value;
      academicData.push({ type, title, desc });
      document.getElementById('academicList').innerHTML =
        academicData.map(a => `<div>[${a.type}] ${a.title}</div>`).join('');
      e.target.reset();
    });

    // Attendance
    document.getElementById('attendanceForm').addEventListener('submit', e => {
      e.preventDefault();
      const subj = attendanceSubject.value, percent = attendancePercent.value;
      const existing = attendance.find(a => a.subject === subj);
      if (existing) existing.percent = percent; else attendance.push({ subject: subj, percent });
      renderAttendance(); updateCharts(); e.target.reset();
    });

    function renderAttendance() {
      const list = document.getElementById('attendanceList');
      list.innerHTML = attendance.map(a => `<div>${a.subject}: ${a.percent}%</div>`).join('');
      document.getElementById('deleteSubject').innerHTML = attendance.map(a => `<option>${a.subject}</option>`).join('');
    }

    function deleteSubject() {
      const subj = deleteSubject.value;
      attendance = attendance.filter(a => a.subject !== subj);
      renderAttendance(); updateCharts();
    }

    // Tests
    document.getElementById('testForm').addEventListener('submit', e => {
      e.preventDefault();
      const subj = testSubject.value, marks = testMarks.value;
      const existing = tests.find(t => t.subject === subj);
      if (existing) existing.marks = marks; else tests.push({ subject: subj, marks });
      renderTests(); updateCharts(); e.target.reset();
    });

    function renderTests() {
      document.getElementById('testList').innerHTML = tests.map(t => `<div>${t.subject}: ${t.marks}</div>`).join('');
      document.getElementById('deleteTest').innerHTML = tests.map(t => `<option>${t.subject}</option>`).join('');
    }

    function deleteTest() {
      const subj = deleteTest.value;
      tests = tests.filter(t => t.subject !== subj);
      renderTests(); updateCharts();
    }

    // Charts
    const attChart = new Chart(document.getElementById('attendanceChart'), {
      type: 'bar', data: { labels: [], datasets: [{ label: 'Attendance %', data: [] }] }
    });
    const testChart = new Chart(document.getElementById('testChart'), {
      type: 'bar', data: { labels: [], datasets: [{ label: 'Test Marks', data: [] }] }
    });

    function updateCharts() {
      attChart.data.labels = attendance.map(a => a.subject);
      attChart.data.datasets[0].data = attendance.map(a => a.percent);
      attChart.update();

      testChart.data.labels = tests.map(t => t.subject);
      testChart.data.datasets[0].data = tests.map(t => t.marks);
      testChart.update();
    }

    function editProfile() {
      const name = prompt("Enter new Admin name:", document.getElementById('adminName').textContent);
      if (name) document.getElementById('adminName').textContent = name;
      const email = prompt("Enter new email:", document.getElementById('adminEmail').textContent);
      if (email) document.getElementById('adminEmail').textContent = email;
    }

    function logout() {
      alert("Logging out...");
      window.location.href = "index.html";
    }

    refreshUsers();
  </script>
</body>
</html>
